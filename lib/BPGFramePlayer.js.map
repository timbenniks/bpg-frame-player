{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 1a8390979de4b876b77e","webpack:///./src/index.js"],"names":[],"mappings":"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","file":"BPGFramePlayer.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"BPGFramePlayer\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"BPGFramePlayer\"] = factory();\n\telse\n\t\troot[\"BPGFramePlayer\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 1a8390979de4b876b77e\n **/","/**\n * BPG Frame Player class\n * @class BPGFramePlayer\n */\nexport default class BPGFramePlayer{\n\n  /**\n   * @typedef BPGFramePlayerOptions\n   * @type Object\n   * @property {object} node Dom node to append player to.\n   * @property {int} width Width of player\n   * @property {int} height Height of player\n   * @property {boolean} loop Loop frames?\n   * @property {boolean} autoplay Autoplay sequence?\n   * @property {string} url URL to the BPH file\n   * @property {string} workerUrl Where to load the webworker from\n   */\n\n  /**\n   * BPGFramePlayer constructor.\n   * @param {BPGFramePlayerOptions} options The default options of the frame player\n   * @constructs BPGFramePlayer\n   */\n  constructor( options ){\n    const noop = function(){};\n\n    const defaultOptions = {\n      node: document.querySelector( '.bpg-frame-player' ),\n      width: 600,\n      height: 300,\n      loop: true,\n      autoplay: true,\n      debug: false,\n      workerUrl: '../lib/bpgdecoder.js',\n      onFrameUpdate: noop,\n      onComplete: noop,\n      onLoaded: noop\n    }\n    \n    this.options = Object.assign( defaultOptions, options );\n    \n    this.playing = this.options.autoplay;\n    this.frameIndex = 0;\n    this.workerId = ( ( ( 1 + Math.random() ) * 0x10000 ) | 0 ).toString( 16 ).substring( 1 );\n\n    if( !this.options.url ){\n      throw new Error( 'A BPG url is needed.' );\n    }\n\n    if( !window.Worker ){\n      throw new Error( 'Cannot decode BPG files without web workers. See: http://caniuse.com/#feat=webworkers' );\n    }\n\n    this.createCanvas();\n\n    this.load( ( arrayBuffer ) => {\n      this.setupWorker( arrayBuffer, ( bpgDecodedData ) => {\n        this.onLoaded( bpgDecodedData );\n      } );\n    } );\n  }\n\n  createCanvas(){\n    this.bpgCanvas = document.createElement( 'canvas' );\n    this.bpgCanvas.width = this.options.width;\n    this.bpgCanvas.height = this.options.height;\n    this.bpgCanvas.classList.add( 'bpg-frame-player' );\n\n    this.options.node.appendChild( this.bpgCanvas );\n    this.ctx = this.bpgCanvas.getContext( '2d' );\n  }\n\n  load( callback ){\n    let request = new XMLHttpRequest();\n\n    this.options.node.classList.add( 'bpg-frame-player-loading' );\n\n    request.open( 'get', this.options.url, true );\n    request.responseType = 'arraybuffer';\n    request.onload = ( event )=> {\n      this.log( 'Requested: ' + this.options.url );\n      callback( request.response );\n    }\n    request.send();\n  }\n\n  setupWorker( bpgData, callback ){\n    let worker = new Worker( this.options.workerUrl );\n   \n    worker.addEventListener( 'message', ( e )=> {\n      if( e.data.type === 'log' ){\n        this.log( 'Decoding BPG: ' + e.data.message );\n      }\n\n      if( e.data.type === 'res' ){\n        worker.terminate();\n        this.log( 'Decoded BPG: ' + this.options.url );\n        callback( e.data );\n      }\n    } );\n    \n    worker.postMessage( { type: 'image', img: bpgData, meta: this.workerId } );\n  }\n\n  onLoaded( bpgDecodedData ){\n    this.frames = bpgDecodedData.frames;\n    this.options.node.classList.remove( 'bpg-frame-player-loading' );\n\n    // start sequence based on duration between first and second frame\n    setTimeout( ()=> { \n      requestAnimationFrame( this.renderFrame.bind( this ) );\n    }, this.frames[ 0 ].duration );\n    \n    // render first frame\n    this.draw( 0 );\n    this.options.onLoaded( this.frames );\n  }\n\n  log( msg ){\n    if( this.options.debug ){\n      console.log( msg );\n    }\n  }\n\n  goToFrame( frame ){\n    this.frameIndex = Math.min( Math.max( frame, 0 ), this.frames.length - 1 );\n    this.draw( this.frameIndex );\n  }\n\n  play(){\n    this.playing = true;\n  } \n\n  pause(){\n    this.playing = false;\n  } \n\n  renderFrame(){\n    if( this.playing ){\n      if( ++this.frameIndex >= this.frames.length ){\n        if( this.options.loop ){\n          this.frameIndex = 0;\n        }\n        else {\n          this.frameIndex = this.frames.length - 1;\n          this.pause();\n          this.options.onComplete( this.frameIndex );\n        }\n      }\n      \n      this.draw( this.frameIndex );\n    }\n\n    let dur = this.frames[ this.frameIndex ].duration;\n    setTimeout( ()=> { \n      requestAnimationFrame( this.renderFrame.bind( this ) );\n    }, dur );\n  }\n\n  draw( frame ){\n    this.options.onFrameUpdate( frame, this.frames.length - 1 );\n    this.ctx.putImageData( this.frames[ frame ].img, 0, 0 );\n  }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/"],"sourceRoot":""}